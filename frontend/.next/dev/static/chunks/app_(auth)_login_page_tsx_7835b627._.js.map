{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///D:/Projects/reddit-clone/frontend/app/%28auth%29/login/page.tsx"],"sourcesContent":["\"use client\"\r\n\r\nimport React, { useState } from \"react\"\r\nimport { signIn, useSession } from \"next-auth/react\"\r\n\r\nexport default function LoginPage() {\r\n    const { data: session, status } = useSession()\r\n    const [loading, setLoading] = useState(false)\r\n    const [error, setError] = useState<string | null>(null)\r\n\r\n    const handleLocalLogin = async (e: React.FormEvent<HTMLFormElement>) => {\r\n        e.preventDefault();\r\n        setLoading(true);\r\n        setError(null);\r\n\r\n        const form = e.currentTarget;\r\n        const email = (form.elements.namedItem(\"email\") as HTMLInputElement).value;\r\n        const password = (form.elements.namedItem(\"password\") as HTMLInputElement).value;\r\n\r\n        const res = await signIn(\"credentials\", {\r\n            redirect: false,           // BẮT BUỘC\r\n            email,\r\n            password,\r\n            callbackUrl: \"/auth/callback\", // nơi dừng để upsert profile\r\n        });\r\n\r\n        setLoading(false);\r\n\r\n        if (res?.error) {\r\n            setError(\"Login failed: \" + res.error);\r\n            return;\r\n        }\r\n\r\n        if (res?.ok) {\r\n            // Redirect đến callback page để xử lý upsert\r\n            window.location.href = res.url ?? \"/auth/callback\";\r\n        }\r\n    };\r\n\r\n\r\n    const handleOAuth = (provider: \"google\") => {\r\n        const from = window.location.pathname;\r\n\r\n        signIn(provider, { callbackUrl: \"/auth/callback\" });\r\n\r\n    };\r\n\r\n\r\n    // ===== UI =====\r\n    return (\r\n        <div style={containerStyle}>\r\n            <div style={boxStyle}>\r\n                <h2 style={{ textAlign: \"center\", marginBottom: 16 }}>Login</h2>\r\n\r\n                {error && <div style={{ color: \"red\", marginBottom: 12 }}>{error}</div>}\r\n\r\n                {/* ===== CHƯA LOGIN ===== */}\r\n                {!session ? (\r\n                    <>\r\n                        <form onSubmit={handleLocalLogin} style={formStyle}>\r\n                            <input\r\n                                type=\"text\"\r\n                                name=\"email\"\r\n                                placeholder=\"Email\"\r\n                                style={inputStyle}\r\n                                required\r\n                            />\r\n                            <input\r\n                                type=\"password\"\r\n                                name=\"password\"\r\n                                placeholder=\"Password\"\r\n                                style={inputStyle}\r\n                                required\r\n                            />\r\n                            <button type=\"submit\" style={btnStyle} disabled={loading}>\r\n                                {loading ? \"Logging in...\" : \"Login\"}\r\n                            </button>\r\n                        </form>\r\n\r\n                        <div style={{ textAlign: \"center\", margin: \"10px 0\", color: \"#9499a0\" }}>\r\n                            ───────────── OR ─────────────\r\n                        </div>\r\n\r\n                        <button\r\n                            style={{ ...oauthBtnStyle, background: \"#4285F4\" }}\r\n                            onClick={() => handleOAuth(\"google\")}\r\n                        >\r\n                            Login with Google\r\n                        </button>\r\n                    </>\r\n                ) : (\r\n                    /* ===== ĐÃ LOGIN ===== */\r\n                    <div style={{ textAlign: \"center\" }}>\r\n                        <p>\r\n                            Welcome,&nbsp;\r\n                            {session.strapiUser?.username ||\r\n                                session.user?.name ||\r\n                                session.user?.email}\r\n                        </p>\r\n\r\n                        {session.user?.image && (\r\n                            <img\r\n                                src={session.user.image}\r\n                                alt=\"avatar\"\r\n                                style={{\r\n                                    width: 60,\r\n                                    height: 60,\r\n                                    borderRadius: \"50%\",\r\n                                    marginTop: 8,\r\n                                }}\r\n                            />\r\n                        )}\r\n                    </div>\r\n                )}\r\n            </div>\r\n        </div>\r\n    )\r\n}\r\n\r\n// Styles\r\nconst containerStyle: React.CSSProperties = {\r\n    display: \"flex\",\r\n    justifyContent: \"center\",\r\n    alignItems: \"center\",\r\n    minHeight: \"calc(100vh - 60px - 50px)\",\r\n    background: \"#f8f9fa\",\r\n    padding: 20,\r\n}\r\n\r\nconst boxStyle: React.CSSProperties = {\r\n    maxWidth: 400,\r\n    width: \"100%\",\r\n    background: \"#fff\",\r\n    padding: \"30px 20px\",\r\n    borderRadius: 8,\r\n    boxShadow: \"0 4px 12px rgba(0,0,0,0.05)\",\r\n}\r\n\r\nconst formStyle: React.CSSProperties = {\r\n    display: \"flex\",\r\n    flexDirection: \"column\",\r\n    gap: 12,\r\n    marginBottom: 16,\r\n}\r\n\r\nconst inputStyle: React.CSSProperties = {\r\n    padding: \"10px 12px\",\r\n    borderRadius: 6,\r\n    border: \"1px solid #cbd5e1\",\r\n    outline: \"none\",\r\n}\r\n\r\nconst btnStyle: React.CSSProperties = {\r\n    padding: \"10px 0\",\r\n    borderRadius: 6,\r\n    border: \"none\",\r\n    backgroundColor: \"#3b82f6\",\r\n    color: \"#fff\",\r\n    fontWeight: \"bold\",\r\n    cursor: \"pointer\",\r\n}\r\n\r\nconst oauthBtnStyle: React.CSSProperties = {\r\n    padding: \"10px 0\",\r\n    borderRadius: 6,\r\n    border: \"none\",\r\n    color: \"#fff\",\r\n    fontWeight: \"bold\",\r\n    cursor: \"pointer\",\r\n}\r\n"],"names":[],"mappings":"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"}}]
}